2025-05-18 21:14:02,949 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:14:02,949 - main - CRITICAL - System failed: cannot access local variable 'settings' where it is not associated with a value
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 273, in main
    initialize_system(args)
    ~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 80, in initialize_system
    settings = settings(args.config)
               ^^^^^^^^
UnboundLocalError: cannot access local variable 'settings' where it is not associated with a value
2025-05-18 21:19:01,742 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:19:01,743 - main - INFO - Loaded configuration profile: default
2025-05-18 21:19:01,758 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 21:19:01,759 - main - INFO - Connected to MongoDB
2025-05-18 21:19:01,759 - main - INFO - Scheduler initialized
2025-05-18 21:19:01,759 - main - INFO - Portfolio Manager initialized
2025-05-18 21:19:01,759 - main - CRITICAL - System failed: DataOrchestrator.__init__() takes from 1 to 2 positional arguments but 3 were given
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 274, in main
    initialize_system(args)
    ~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 111, in initialize_system
    data_orchestrator = DataOrchestrator(db_connector, portfolio_manager)
TypeError: DataOrchestrator.__init__() takes from 1 to 2 positional arguments but 3 were given
2025-05-18 21:19:02,263 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 21:27:48,326 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:27:48,327 - main - INFO - Loaded configuration profile: default
2025-05-18 21:27:48,333 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 21:27:48,333 - main - INFO - Connected to MongoDB
2025-05-18 21:27:48,333 - main - INFO - Scheduler initialized
2025-05-18 21:27:48,334 - main - INFO - Portfolio Manager initialized
2025-05-18 21:27:48,334 - main - INFO - Data Orchestrator initialized
2025-05-18 21:27:48,334 - main - WARNING - Market Analyzer not available: No module named 'research.market_analyzer'
2025-05-18 21:27:48,335 - main - WARNING - Notification Manager not available: No module named 'notifications'
2025-05-18 21:27:48,445 - main - INFO - Market Hours initialized
2025-05-18 21:27:48,446 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 21:27:48,446 - main - WARNING - Workflow components not available: No module named 'automation.workflows'
2025-05-18 21:27:48,446 - main - INFO - System initialization complete
2025-05-18 21:27:48,446 - main - INFO - Starting live system...
2025-05-18 21:27:48,446 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 323, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 252, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 21:27:48,837 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 21:31:34,684 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:31:34,684 - main - INFO - Loaded configuration profile: default
2025-05-18 21:31:34,691 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 21:31:34,691 - main - INFO - Connected to MongoDB
2025-05-18 21:31:34,691 - main - INFO - Scheduler initialized
2025-05-18 21:31:34,692 - main - INFO - Portfolio Manager initialized
2025-05-18 21:31:34,692 - main - INFO - Data Orchestrator initialized
2025-05-18 21:31:34,692 - main - WARNING - Market Analyzer not available: No module named 'research.market_analyzer'
2025-05-18 21:31:34,693 - main - WARNING - Notification Manager not available: No module named 'notifications'
2025-05-18 21:31:34,723 - main - INFO - Market Hours initialized
2025-05-18 21:31:34,723 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 21:31:34,723 - main - WARNING - Workflow components not available: No module named 'automation.workflows'
2025-05-18 21:31:34,723 - main - INFO - System initialization complete
2025-05-18 21:31:34,723 - main - INFO - Starting live system...
2025-05-18 21:31:34,723 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 374, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 303, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 21:31:35,192 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 21:42:07,849 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:42:07,849 - main - INFO - Loaded configuration profile: default
2025-05-18 21:42:07,856 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 21:42:07,856 - main - INFO - Connected to MongoDB
2025-05-18 21:42:07,856 - main - INFO - Scheduler initialized
2025-05-18 21:42:07,856 - main - INFO - Portfolio Manager initialized
2025-05-18 21:42:07,857 - main - INFO - Data Orchestrator initialized
2025-05-18 21:42:07,857 - main - WARNING - Market Analyzer not available: No module named 'research.market_analyzer'
2025-05-18 21:42:07,857 - main - WARNING - Notification Manager not available: No module named 'notifications'
2025-05-18 21:42:07,894 - main - INFO - Market Hours initialized
2025-05-18 21:42:07,895 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 21:42:07,895 - main - WARNING - Workflow components not available: No module named 'automation.workflows'
2025-05-18 21:42:07,895 - main - INFO - System initialization complete
2025-05-18 21:42:07,895 - main - INFO - Starting live system...
2025-05-18 21:42:07,895 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 374, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 303, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 21:42:08,360 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 21:49:55,974 - main - INFO - Initializing Automated Trading System...
2025-05-18 21:49:55,974 - main - INFO - Loaded configuration profile: default
2025-05-18 21:49:56,027 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 21:49:56,028 - main - INFO - Connected to MongoDB
2025-05-18 21:49:56,028 - main - INFO - Scheduler initialized
2025-05-18 21:49:56,028 - main - INFO - Portfolio Manager initialized
2025-05-18 21:49:56,029 - main - INFO - Data Orchestrator initialized
2025-05-18 21:49:56,029 - main - INFO - Market Analyzer initialized
2025-05-18 21:49:56,029 - main - INFO - Notification Manager initialized
2025-05-18 21:49:56,062 - main - INFO - Market Hours initialized
2025-05-18 21:49:56,062 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 21:49:56,063 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 21:49:56,063 - main - INFO - System initialization complete
2025-05-18 21:49:56,063 - main - INFO - Starting live system...
2025-05-18 21:49:56,063 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 302, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 21:49:56,532 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 22:19:18,229 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:19:18,229 - main - INFO - Loaded configuration profile: default
2025-05-18 22:19:18,241 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:19:18,241 - main - INFO - Connected to MongoDB
2025-05-18 22:19:18,241 - main - INFO - Scheduler initialized
2025-05-18 22:19:18,241 - main - INFO - Portfolio Manager initialized
2025-05-18 22:19:18,242 - main - INFO - Data Orchestrator initialized
2025-05-18 22:19:18,242 - main - INFO - Market Analyzer initialized
2025-05-18 22:19:18,242 - main - INFO - Notification Manager initialized
2025-05-18 22:19:18,277 - main - INFO - Market Hours initialized
2025-05-18 22:19:18,277 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:19:18,278 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:19:18,278 - main - INFO - System initialization complete
2025-05-18 22:19:18,278 - main - INFO - Starting live system...
2025-05-18 22:19:18,278 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 302, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 22:19:18,746 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 22:28:16,135 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:28:16,135 - main - INFO - Loaded configuration profile: default
2025-05-18 22:28:16,144 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:28:16,144 - main - INFO - Connected to MongoDB
2025-05-18 22:28:16,144 - main - INFO - Scheduler initialized
2025-05-18 22:28:16,144 - main - INFO - Portfolio Manager initialized
2025-05-18 22:28:16,145 - main - INFO - Data Orchestrator initialized
2025-05-18 22:28:16,145 - main - INFO - Market Analyzer initialized
2025-05-18 22:28:16,145 - main - INFO - Notification Manager initialized
2025-05-18 22:28:16,190 - main - INFO - Market Hours initialized
2025-05-18 22:28:16,190 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:28:16,191 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:28:16,191 - main - INFO - System initialization complete
2025-05-18 22:28:16,191 - main - INFO - Starting live system...
2025-05-18 22:28:16,191 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 302, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 22:28:16,645 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 22:32:03,390 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:32:03,390 - main - INFO - Loaded configuration profile: default
2025-05-18 22:32:03,443 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:32:03,443 - main - INFO - Connected to MongoDB
2025-05-18 22:32:03,444 - main - INFO - Scheduler initialized
2025-05-18 22:32:03,444 - main - INFO - Portfolio Manager initialized
2025-05-18 22:32:03,445 - main - INFO - Data Orchestrator initialized
2025-05-18 22:32:03,445 - main - INFO - Market Analyzer initialized
2025-05-18 22:32:03,445 - main - INFO - Notification Manager initialized
2025-05-18 22:32:03,481 - main - INFO - Market Hours initialized
2025-05-18 22:32:03,481 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:32:03,482 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:32:03,482 - main - INFO - System initialization complete
2025-05-18 22:32:03,482 - main - INFO - Starting live system...
2025-05-18 22:32:03,482 - main - CRITICAL - System failed: 'scheduler'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 302, in run_live_system
    scheduler = system_components['scheduler']
                ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'scheduler'
2025-05-18 22:32:03,946 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 22:33:35,393 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:33:35,393 - main - INFO - Loaded configuration profile: default
2025-05-18 22:33:35,445 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:33:35,446 - main - INFO - Connected to MongoDB
2025-05-18 22:33:35,446 - main - INFO - Scheduler initialized
2025-05-18 22:33:35,446 - main - INFO - Portfolio Manager initialized
2025-05-18 22:33:35,447 - main - INFO - Data Orchestrator initialized
2025-05-18 22:33:35,447 - main - INFO - Market Analyzer initialized
2025-05-18 22:33:35,447 - main - INFO - Notification Manager initialized
2025-05-18 22:33:35,482 - main - INFO - Market Hours initialized
2025-05-18 22:33:35,482 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:33:35,482 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:33:35,483 - main - INFO - System initialization complete
2025-05-18 22:33:35,483 - main - INFO - Starting live system...
2025-05-18 22:33:35,483 - main - CRITICAL - System failed: 'NotificationManager' object has no attribute 'send_alert'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 311, in run_live_system
    notification_manager.send_alert("Automated Trading System started", level="info")
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NotificationManager' object has no attribute 'send_alert'
2025-05-18 22:41:40,192 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:41:40,193 - main - INFO - Loaded configuration profile: default
2025-05-18 22:41:40,245 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:41:40,245 - main - INFO - Connected to MongoDB
2025-05-18 22:41:40,246 - main - INFO - Scheduler initialized
2025-05-18 22:41:40,246 - main - INFO - Portfolio Manager initialized
2025-05-18 22:41:40,247 - main - INFO - Data Orchestrator initialized
2025-05-18 22:41:40,247 - main - INFO - Market Analyzer initialized
2025-05-18 22:41:40,247 - main - INFO - Notification Manager initialized
2025-05-18 22:41:40,285 - main - INFO - Market Hours initialized
2025-05-18 22:41:40,285 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:41:40,286 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:41:40,286 - main - INFO - System initialization complete
2025-05-18 22:41:40,286 - main - INFO - Starting live system...
2025-05-18 22:41:40,287 - main - CRITICAL - System failed: 'NotificationManager' object has no attribute 'send_alert'
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 373, in main
    run_live_system()
    ~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/main.py", line 311, in run_live_system
    notification_manager.send_alert("Automated Trading System started", level="info")
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NotificationManager' object has no attribute 'send_alert'
2025-05-18 22:57:35,926 - main - INFO - Initializing Automated Trading System...
2025-05-18 22:57:35,927 - main - INFO - Loaded configuration profile: default
2025-05-18 22:57:35,936 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading_system
2025-05-18 22:57:35,936 - main - INFO - Connected to MongoDB
2025-05-18 22:57:35,936 - main - INFO - Scheduler initialized
2025-05-18 22:57:35,936 - main - INFO - Portfolio Manager initialized
2025-05-18 22:57:35,937 - main - INFO - Data Orchestrator initialized
2025-05-18 22:57:35,937 - main - INFO - Market Analyzer initialized
2025-05-18 22:57:35,937 - main - INFO - Notification Manager initialized
2025-05-18 22:57:35,973 - main - INFO - Market Hours initialized
2025-05-18 22:57:35,973 - main - INFO - Trading Controller initialized in paper mode
2025-05-18 22:57:35,974 - main - WARNING - Workflow components not available: cannot import name 'DailyWorkflow' from 'automation' (unknown location)
2025-05-18 22:57:35,974 - main - INFO - System initialization complete
2025-05-18 22:57:35,974 - main - INFO - Starting live system...
2025-05-18 23:04:27,967 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:04:27,967 - init_db - INFO - Initializing database...
2025-05-18 23:04:27,968 - init_db - ERROR - Error initializing database: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-18 23:07:43,155 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:07:43,155 - init_db - INFO - Initializing database...
2025-05-18 23:07:43,195 - database.mongodb_connector - INFO - Created collection: portfolio
2025-05-18 23:07:43,235 - database.mongodb_connector - INFO - Created collection: market_data
2025-05-18 23:07:43,267 - database.mongodb_connector - INFO - Created collection: news
2025-05-18 23:07:43,297 - database.mongodb_connector - INFO - Created collection: financial
2025-05-18 23:07:43,333 - database.mongodb_connector - INFO - Created collection: predictions
2025-05-18 23:07:43,367 - database.mongodb_connector - INFO - Created collection: trades
2025-05-18 23:07:43,396 - database.mongodb_connector - INFO - Created collection: performance
2025-05-18 23:07:43,431 - database.mongodb_connector - INFO - Created collection: system_logs
2025-05-18 23:07:43,470 - database.mongodb_connector - INFO - Created collection: tasks
2025-05-18 23:07:43,500 - database.mongodb_connector - INFO - Created collection: conversations
2025-05-18 23:07:43,529 - database.mongodb_connector - INFO - Created collection: notifications
2025-05-18 23:07:43,563 - database.mongodb_connector - INFO - Created collection: reports
2025-05-18 23:07:43,718 - database.mongodb_connector - INFO - Database initialized with collections and indexes
2025-05-18 23:07:43,718 - init_db - INFO - Database initialized successfully
2025-05-18 23:09:37,661 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:09:37,661 - system - ERROR - ERROR: NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None | Context: {'action': 'add_instrument', 'symbol': 'TATASTEEL', 'exchange': 'NSE'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/portfolio/portfolio_manager.py", line 61, in add_instrument
    existing = self.db.find_one(
        "portfolio",
    ...<4 lines>...
        }
    )
  File "/Users/ashokbathu/Documents/automated_trading_system/database/mongodb_connector.py", line 325, in find_one
    self._ensure_connected()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/database/mongodb_connector.py", line 225, in _ensure_connected
    if not self.client or not self.db:
                              ^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pymongo/synchronous/database.py", line 342, in __bool__
    raise NotImplementedError(
    ...<3 lines>...
    )
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-18 23:09:37,663 - __main__ - ERROR - Failed to add instrument TATASTEEL:NSE to portfolio
2025-05-18 23:14:21,174 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:14:21,176 - portfolio.portfolio_manager - INFO - Added instrument TATASTEEL:NSE to portfolio
2025-05-18 23:14:21,184 - portfolio.data_pipeline_trigger - INFO - Triggered data collection for TATASTEEL:NSE
2025-05-18 23:14:21,186 - __main__ - INFO - Added instrument TATASTEEL:NSE to portfolio (ID: 682a1c75e463d613e043c88b)
2025-05-18 23:14:21,187 - portfolio.instrument_setup - INFO - Set up instrument TATASTEEL:NSE with configuration
2025-05-18 23:14:21,187 - portfolio.data_pipeline_trigger - INFO - Collecting historical data for TATASTEEL:NSE
2025-05-18 23:15:27,186 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:15:27,187 - __main__ - INFO - Collecting data for TATASTEEL:NSE
2025-05-18 23:15:27,187 - __main__ - INFO - Starting data collection for TATASTEEL:NSE
2025-05-18 23:15:27,189 - portfolio.portfolio_manager - INFO - Updated all data collection status for TATASTEEL:NSE to False
2025-05-18 23:15:27,189 - __main__ - INFO - Collecting historical data for TATASTEEL:NSE
2025-05-18 23:15:27,189 - portfolio.data_pipeline_trigger - INFO - Collecting historical data for TATASTEEL:NSE
2025-05-18 23:15:28,337 - portfolio.portfolio_manager - INFO - Updated historical data collection status for TATASTEEL:NSE to True
2025-05-18 23:15:28,338 - portfolio.data_pipeline_trigger - INFO - Completed historical data collection for TATASTEEL:NSE
2025-05-18 23:15:28,338 - __main__ - INFO - Collecting financial data for TATASTEEL:NSE
2025-05-18 23:15:28,338 - portfolio.data_pipeline_trigger - INFO - Collecting financial data for TATASTEEL:NSE
2025-05-18 23:15:28,612 - data.financial.financial_scraper - INFO - Starting financial data collection for TATASTEEL:NSE
2025-05-18 23:15:28,612 - data.financial.financial_scraper - INFO - Scraping Screener.in data for TATASTEEL
2025-05-18 23:15:31,269 - data.financial.financial_scraper - INFO - Successfully scraped Screener.in data for TATASTEEL
2025-05-18 23:15:31,270 - data.financial.financial_scraper - INFO - Scraping Zerodha Markets data for TATASTEEL
2025-05-18 23:15:34,133 - data.financial.financial_scraper - INFO - Successfully scraped Zerodha Markets data for TATASTEEL
2025-05-18 23:15:34,134 - data.financial.financial_scraper - INFO - Scraping Tijori Finance data for TATASTEEL
2025-05-18 23:15:38,525 - data.financial.financial_scraper - INFO - Successfully scraped Tijori Finance data for TATASTEEL
2025-05-18 23:15:38,526 - system - ERROR - ERROR: ModuleNotFoundError: No module named 'financial_data' | Context: {'action': 'save_to_database', 'symbol': 'TATASTEEL'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'
2025-05-18 23:15:38,527 - system - ERROR - ERROR: AttributeError: 'MongoDBConnector' object has no attribute 'rollback' | Context: {'action': 'run_financial_scraper', 'symbol': 'TATASTEEL'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 121, in run
    self._save_to_database()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1292, in _save_to_database
    self.db.rollback()
    ^^^^^^^^^^^^^^^^
AttributeError: 'MongoDBConnector' object has no attribute 'rollback'
2025-05-18 23:15:38,528 - portfolio.data_pipeline_trigger - ERROR - Failed to collect financial data for TATASTEEL:NSE
2025-05-18 23:15:38,529 - portfolio.portfolio_manager - INFO - Updated financial data collection status for TATASTEEL:NSE to False
2025-05-18 23:15:38,529 - __main__ - INFO - Collecting news data for TATASTEEL:NSE
2025-05-18 23:15:38,529 - portfolio.data_pipeline_trigger - INFO - Collecting news data for TATASTEEL:NSE
2025-05-18 23:15:42,607 - data.news.news_aggregator - INFO - Collecting news for TATASTEEL:NSE (last 30 days)
2025-05-18 23:15:42,609 - data.news.news_aggregator - INFO - Collecting news from zerodha_pulse for TATASTEEL
2025-05-18 23:15:42,610 - data.news.news_aggregator - WARNING - PulseScraper not available, using fallback implementation
2025-05-18 23:15:46,461 - data.news.news_aggregator - INFO - No news found from zerodha_pulse for TATASTEEL
2025-05-18 23:15:46,462 - data.news.news_aggregator - INFO - Collecting news from economic_times for TATASTEEL
2025-05-18 23:15:51,431 - data.news.news_aggregator - INFO - No news found from economic_times for TATASTEEL
2025-05-18 23:15:51,431 - data.news.news_aggregator - INFO - Collecting news from bloomberg for TATASTEEL
2025-05-18 23:16:00,985 - data.news.news_aggregator - INFO - No news found from bloomberg for TATASTEEL
2025-05-18 23:16:00,985 - data.news.news_aggregator - INFO - Collecting news from hindu_business for TATASTEEL
2025-05-18 23:16:01,297 - data.news.news_aggregator - INFO - No news found from hindu_business for TATASTEEL
2025-05-18 23:16:01,297 - data.news.news_aggregator - INFO - Collecting news from zerodha_markets for TATASTEEL
2025-05-18 23:16:01,948 - data.news.news_aggregator - INFO - No news found from zerodha_markets for TATASTEEL
2025-05-18 23:16:01,948 - data.news.news_aggregator - INFO - Collecting news from tijori_finance for TATASTEEL
2025-05-18 23:16:03,556 - data.news.news_aggregator - INFO - No news found from tijori_finance for TATASTEEL
2025-05-18 23:16:03,556 - data.news.news_aggregator - INFO - Saved 0 news items for TATASTEEL:NSE
2025-05-18 23:16:03,558 - portfolio.portfolio_manager - INFO - Updated news data collection status for TATASTEEL:NSE to True
2025-05-18 23:16:03,559 - portfolio.data_pipeline_trigger - INFO - Collected 0 news items for TATASTEEL:NSE
2025-05-18 23:16:03,559 - __main__ - INFO - Collecting global data for TATASTEEL:NSE
2025-05-18 23:16:03,559 - portfolio.data_pipeline_trigger - INFO - Collecting global data for TATASTEEL:NSE (sector: metal)
2025-05-18 23:16:03,567 - portfolio.data_pipeline_trigger - WARNING - GlobalIndicesCollector not available, using placeholder
2025-05-18 23:16:03,567 - placeholder_collector - INFO - Placeholder: Collecting global data for sector: metal
2025-05-18 23:16:03,568 - portfolio.portfolio_manager - INFO - Updated global data collection status for TATASTEEL:NSE to True
2025-05-18 23:16:03,569 - portfolio.data_pipeline_trigger - INFO - Completed global data collection for TATASTEEL:NSE (sector: metal)
2025-05-18 23:16:04,248 - database.mongodb_connector - ERROR - Error closing MongoDB connection: sys.meta_path is None, Python is likely shutting down
2025-05-18 23:16:04,249 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 23:50:18,488 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:50:18,490 - __main__ - INFO - Collecting data for TATASTEEL:NSE
2025-05-18 23:50:18,490 - __main__ - INFO - Starting data collection for TATASTEEL:NSE
2025-05-18 23:50:18,491 - portfolio.portfolio_manager - INFO - Updated all data collection status for TATASTEEL:NSE to False
2025-05-18 23:50:18,491 - __main__ - INFO - Collecting historical data for TATASTEEL:NSE
2025-05-18 23:50:18,491 - portfolio.data_pipeline_trigger - INFO - Collecting historical data for TATASTEEL:NSE
2025-05-18 23:50:19,811 - portfolio.portfolio_manager - INFO - Updated historical data collection status for TATASTEEL:NSE to True
2025-05-18 23:50:19,812 - portfolio.data_pipeline_trigger - INFO - Completed historical data collection for TATASTEEL:NSE
2025-05-18 23:50:19,813 - __main__ - INFO - Collecting financial data for TATASTEEL:NSE
2025-05-18 23:50:19,813 - portfolio.data_pipeline_trigger - INFO - Collecting financial data for TATASTEEL:NSE
2025-05-18 23:50:19,957 - data.financial.financial_scraper - INFO - Starting financial data collection for TATASTEEL:NSE
2025-05-18 23:50:19,957 - data.financial.financial_scraper - INFO - Scraping Screener.in data for TATASTEEL
2025-05-18 23:50:22,633 - data.financial.financial_scraper - INFO - Successfully scraped Screener.in data for TATASTEEL
2025-05-18 23:50:22,633 - data.financial.financial_scraper - INFO - Scraping Zerodha Markets data for TATASTEEL
2025-05-18 23:50:28,406 - data.financial.financial_scraper - INFO - Successfully scraped Zerodha Markets data for TATASTEEL
2025-05-18 23:50:28,407 - data.financial.financial_scraper - INFO - Scraping Tijori Finance data for TATASTEEL
2025-05-18 23:50:32,522 - data.financial.financial_scraper - INFO - Successfully scraped Tijori Finance data for TATASTEEL
2025-05-18 23:50:32,522 - system - ERROR - ERROR: ModuleNotFoundError: No module named 'financial_data' | Context: {'action': 'save_to_database', 'symbol': 'TATASTEEL'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'
2025-05-18 23:50:32,531 - system - ERROR - ERROR: AttributeError: 'MongoDBConnector' object has no attribute 'rollback' | Context: {'action': 'run_financial_scraper', 'symbol': 'TATASTEEL'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 121, in run
    self._save_to_database()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1292, in _save_to_database
    self.db.rollback()
    ^^^^^^^^^^^^^^^^
AttributeError: 'MongoDBConnector' object has no attribute 'rollback'
2025-05-18 23:50:32,533 - portfolio.data_pipeline_trigger - ERROR - Failed to collect financial data for TATASTEEL:NSE
2025-05-18 23:50:32,535 - portfolio.portfolio_manager - INFO - Updated financial data collection status for TATASTEEL:NSE to False
2025-05-18 23:50:32,535 - __main__ - INFO - Collecting news data for TATASTEEL:NSE
2025-05-18 23:50:32,535 - portfolio.data_pipeline_trigger - INFO - Collecting news data for TATASTEEL:NSE
2025-05-18 23:50:35,580 - data.news.news_aggregator - INFO - Collecting news for TATASTEEL:NSE (last 30 days)
2025-05-18 23:50:35,582 - data.news.news_aggregator - INFO - Collecting news from zerodha_pulse for TATASTEEL
2025-05-18 23:50:35,583 - data.news.news_aggregator - WARNING - PulseScraper not available, using fallback implementation
2025-05-18 23:50:38,048 - data.news.news_aggregator - INFO - No news found from zerodha_pulse for TATASTEEL
2025-05-18 23:50:38,049 - data.news.news_aggregator - INFO - Collecting news from economic_times for TATASTEEL
2025-05-18 23:50:43,298 - data.news.news_aggregator - INFO - No news found from economic_times for TATASTEEL
2025-05-18 23:50:43,299 - data.news.news_aggregator - INFO - Collecting news from bloomberg for TATASTEEL
2025-05-18 23:50:47,545 - data.news.news_aggregator - INFO - No news found from bloomberg for TATASTEEL
2025-05-18 23:50:47,545 - data.news.news_aggregator - INFO - Collecting news from hindu_business for TATASTEEL
2025-05-18 23:50:53,969 - system - ERROR - ERROR: ConnectionError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer')) | Context: {'action': 'collect_hindu_business', 'symbol': 'TATASTEEL'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connection.py", line 741, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/connection.py", line 920, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/urllib3/util/ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/news/news_aggregator.py", line 742, in _collect_hindu_business
    response = requests.get(url, headers=self.headers)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))
2025-05-18 23:50:54,002 - data.news.news_aggregator - INFO - No news found from hindu_business for TATASTEEL
2025-05-18 23:50:54,002 - data.news.news_aggregator - INFO - Collecting news from zerodha_markets for TATASTEEL
2025-05-18 23:50:54,548 - data.news.news_aggregator - INFO - No news found from zerodha_markets for TATASTEEL
2025-05-18 23:50:54,548 - data.news.news_aggregator - INFO - Collecting news from tijori_finance for TATASTEEL
2025-05-18 23:50:57,035 - data.news.news_aggregator - INFO - No news found from tijori_finance for TATASTEEL
2025-05-18 23:50:57,035 - data.news.news_aggregator - INFO - Saved 0 news items for TATASTEEL:NSE
2025-05-18 23:50:57,037 - portfolio.portfolio_manager - INFO - Updated news data collection status for TATASTEEL:NSE to True
2025-05-18 23:50:57,038 - portfolio.data_pipeline_trigger - INFO - Collected 0 news items for TATASTEEL:NSE
2025-05-18 23:50:57,038 - __main__ - INFO - Collecting global data for TATASTEEL:NSE
2025-05-18 23:50:57,038 - portfolio.data_pipeline_trigger - INFO - Collecting global data for TATASTEEL:NSE (sector: metal)
2025-05-18 23:50:57,046 - portfolio.data_pipeline_trigger - WARNING - GlobalIndicesCollector not available, using placeholder
2025-05-18 23:50:57,046 - placeholder_collector - INFO - Placeholder: Collecting global data for sector: metal
2025-05-18 23:50:57,048 - portfolio.portfolio_manager - INFO - Updated global data collection status for TATASTEEL:NSE to True
2025-05-18 23:50:57,049 - portfolio.data_pipeline_trigger - INFO - Completed global data collection for TATASTEEL:NSE (sector: metal)
2025-05-18 23:50:57,463 - database.mongodb_connector - ERROR - Error closing MongoDB connection: sys.meta_path is None, Python is likely shutting down
2025-05-18 23:50:57,464 - database.mongodb_connector - INFO - MongoDB connection closed
2025-05-18 23:55:03,711 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:55:03,713 - portfolio.portfolio_manager - INFO - Added instrument BEML:NSE to portfolio
2025-05-18 23:55:03,714 - portfolio.data_pipeline_trigger - INFO - Triggered data collection for BEML:NSE
2025-05-18 23:55:03,714 - __main__ - INFO - Added instrument BEML:NSE to portfolio (ID: 682a25ffde443b9043b58ee9)
2025-05-18 23:55:03,721 - portfolio.instrument_setup - INFO - Set up instrument BEML:NSE with configuration
2025-05-18 23:55:03,721 - portfolio.data_pipeline_trigger - INFO - Collecting historical data for BEML:NSE
2025-05-18 23:55:32,231 - database.mongodb_connector - INFO - Connected to MongoDB database: automated_trading
2025-05-18 23:55:32,232 - __main__ - INFO - Collecting data for BEML:NSE
2025-05-18 23:55:32,232 - __main__ - INFO - Starting data collection for BEML:NSE
2025-05-18 23:55:32,233 - portfolio.portfolio_manager - INFO - Updated all data collection status for BEML:NSE to False
2025-05-18 23:55:32,233 - __main__ - INFO - Collecting historical data for BEML:NSE
2025-05-18 23:55:32,233 - portfolio.data_pipeline_trigger - INFO - Collecting historical data for BEML:NSE
2025-05-18 23:55:33,361 - portfolio.portfolio_manager - INFO - Updated historical data collection status for BEML:NSE to True
2025-05-18 23:55:33,362 - portfolio.data_pipeline_trigger - INFO - Completed historical data collection for BEML:NSE
2025-05-18 23:55:33,363 - __main__ - INFO - Collecting financial data for BEML:NSE
2025-05-18 23:55:33,363 - portfolio.data_pipeline_trigger - INFO - Collecting financial data for BEML:NSE
2025-05-18 23:55:33,451 - data.financial.financial_scraper - INFO - Starting financial data collection for BEML:NSE
2025-05-18 23:55:33,451 - data.financial.financial_scraper - INFO - Scraping Screener.in data for BEML
2025-05-18 23:55:36,328 - data.financial.financial_scraper - INFO - Successfully scraped Screener.in data for BEML
2025-05-18 23:55:36,328 - data.financial.financial_scraper - INFO - Scraping Zerodha Markets data for BEML
2025-05-18 23:55:39,689 - data.financial.financial_scraper - INFO - Successfully scraped Zerodha Markets data for BEML
2025-05-18 23:55:39,690 - data.financial.financial_scraper - INFO - Scraping Tijori Finance data for BEML
2025-05-18 23:55:43,937 - data.financial.financial_scraper - INFO - Successfully scraped Tijori Finance data for BEML
2025-05-18 23:55:43,938 - system - ERROR - ERROR: ModuleNotFoundError: No module named 'financial_data' | Context: {'action': 'save_to_database', 'symbol': 'BEML'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'
2025-05-18 23:55:43,939 - system - ERROR - ERROR: AttributeError: 'MongoDBConnector' object has no attribute 'rollback' | Context: {'action': 'run_financial_scraper', 'symbol': 'BEML'}
Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1205, in _save_to_database
    from financial_data import FinancialData
ModuleNotFoundError: No module named 'financial_data'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 121, in run
    self._save_to_database()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/ashokbathu/Documents/automated_trading_system/data/financial/financial_scraper.py", line 1292, in _save_to_database
    self.db.rollback()
    ^^^^^^^^^^^^^^^^
AttributeError: 'MongoDBConnector' object has no attribute 'rollback'
2025-05-18 23:55:43,940 - portfolio.data_pipeline_trigger - ERROR - Failed to collect financial data for BEML:NSE
2025-05-18 23:55:43,941 - portfolio.portfolio_manager - INFO - Updated financial data collection status for BEML:NSE to False
2025-05-18 23:55:43,941 - __main__ - INFO - Collecting news data for BEML:NSE
2025-05-18 23:55:43,942 - portfolio.data_pipeline_trigger - INFO - Collecting news data for BEML:NSE
2025-05-18 23:55:45,104 - data.news.news_aggregator - INFO - Collecting news for BEML:NSE (last 30 days)
2025-05-18 23:55:45,107 - data.news.news_aggregator - INFO - Collecting news from zerodha_pulse for BEML
2025-05-18 23:55:45,107 - data.news.news_aggregator - WARNING - PulseScraper not available, using fallback implementation
2025-05-18 23:55:47,901 - data.news.news_aggregator - INFO - No news found from zerodha_pulse for BEML
2025-05-18 23:55:47,901 - data.news.news_aggregator - INFO - Collecting news from economic_times for BEML
2025-05-18 23:55:54,666 - data.news.news_aggregator - INFO - No news found from economic_times for BEML
2025-05-18 23:55:54,666 - data.news.news_aggregator - INFO - Collecting news from bloomberg for BEML
2025-05-18 23:56:00,293 - data.news.news_aggregator - INFO - No news found from bloomberg for BEML
2025-05-18 23:56:00,293 - data.news.news_aggregator - INFO - Collecting news from hindu_business for BEML
2025-05-18 23:56:01,633 - data.news.news_aggregator - INFO - No news found from hindu_business for BEML
2025-05-18 23:56:01,633 - data.news.news_aggregator - INFO - Collecting news from zerodha_markets for BEML
2025-05-18 23:56:02,445 - data.news.news_aggregator - INFO - No news found from zerodha_markets for BEML
2025-05-18 23:56:02,445 - data.news.news_aggregator - INFO - Collecting news from tijori_finance for BEML
2025-05-18 23:56:04,912 - data.news.news_aggregator - INFO - No news found from tijori_finance for BEML
2025-05-18 23:56:04,912 - data.news.news_aggregator - INFO - Saved 0 news items for BEML:NSE
2025-05-18 23:56:04,914 - portfolio.portfolio_manager - INFO - Updated news data collection status for BEML:NSE to True
2025-05-18 23:56:04,915 - portfolio.data_pipeline_trigger - INFO - Collected 0 news items for BEML:NSE
2025-05-18 23:56:04,916 - __main__ - INFO - Collecting global data for BEML:NSE
2025-05-18 23:56:04,916 - portfolio.data_pipeline_trigger - WARNING - No sector specified for BEML:NSE, skipping global data collection
2025-05-18 23:56:04,917 - portfolio.portfolio_manager - INFO - Updated global data collection status for BEML:NSE to True
2025-05-18 23:56:05,155 - database.mongodb_connector - ERROR - Error closing MongoDB connection: sys.meta_path is None, Python is likely shutting down
2025-05-18 23:56:05,156 - database.mongodb_connector - INFO - MongoDB connection closed
